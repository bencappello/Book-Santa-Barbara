<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.13.2/jquery-ui.min.js" integrity="sha512-57oZ/vW8ANMjR/KQ6Be9v/+/h6bq9/l3f0Oc7vn6qMqyhvPd1cvKBRWWpzu0QoneImqr2SkmO4MSqU+RpHom3Q==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<script src="https://cdn.jsdelivr.net/npm/timepicker@1.14.1/jquery.timepicker.min.js"></script>
<script src="https://cdn.jsdelivr.net/gh/bencappello/book-santa-barbara@main/js/satelliteCateringVarsDefaults3.js?v=11"></script>
<script src="https://cdn.jsdelivr.net/gh/bencappello/book-santa-barbara/js/dateTimePickers.js?"></script>
<script>

//onchange
startTime.oninput = calculateChange;
endTime.oninput = calculateChange;
guestsSlider.oninput = calculateChange;
guestsSlider.onchange = calculateChange;
guestsInput.onchange = calculateChange;

buffetInput.oninput = onBuffetInput;
familyInput.oninput = onFamilyInput;
platedInput.oninput = onPlatedInput;

document.getElementsByName('bread-service').forEach(function(el) {
    el.oninput = onBreadInput;
});
document.getElementsByName('odds-and-ends').forEach(function(el) {
    el.oninput = onOddsEndsInput;
});

stationAppetizersInput.oninput = calculateChange;
passedSavoryAppetizersInput.oninput = calculateChange;
passedDessertsInput.oninput = calculateChange;

lunchInput.onchange = calculateChange;

guestsInput.onchange = calculateChange;
guestsInput.onchange = calculateChange;

//Calculation
function calculateChange() {
    console.log("calculateChange");

  var eventDateObject = new Date(eventDateInput.value);
  var foodMinLineItem = calculateFoodMinLineItem();
  var totalCost = calculateTotalCost();

  guestsInput.value = guestsSlider.value;

  if (eventDateInput.value) { 
    dateLineItem.style.display = 'flex';
    eventDateDisplay.innerHTML = eventDateObject.toLocaleString("en-US", {
        month: 'long',
        day: 'numeric',
        year: 'numeric'
    });
  };
  if (startTimeInput.value) { 
    startLineItem.style.display = 'flex';
    startTimeDisplay.innerHTML = startTimeInput.value.replace(":00", ":00 ");
  };
  if (endTimeInput.value) { 
    endLineItem.style.display = 'flex';
    endTimeDisplay.innerHTML = endTimeInput.value.replace(":00", ":00 ");
  };
  if (guestsInput.value && guestsInput.value !== '0') { 
    guestsLineItem.style.display = 'flex';
    guestCountDisplay.innerHTML = guestsInput.value;
  };

  //cost updating

  if (typeof foodMinLineItem === 'number') {
    foodMinDisplay.innerHTML = "$" + foodMinLineItem.toString();
  } else {
    foodMinDisplay.innerHTML = foodMinLineItem.toString();
  }

  totalCostDisplay.innerHTML = "$" + totalCost.toString();
  totalCostInput.value = totalCost;
  depositDisplay.innerHTML = "$" + calculateDeposit(totalCost).toString();
  depositInput.value = calculateDeposit(totalCost);
};

function onBuffetInput() {
    if (buffetInput.checked === true) {
        familyInput.checked = false;
        platedInput.checked = false;
    };

    calculateChange();
}
function onFamilyInput() {
    if (familyInput.checked === true) {
        buffetInput.checked = false;
        platedInput.checked = false;
    };
    
    calculateChange();
}
function onPlatedInput() {
    if (platedInput.checked === true) {
        buffetInput.checked = false;
        familyInput.checked = false;
    };
    
    calculateChange();
}
function onBreadInput() {
    if (this.checked === true) {
        document.getElementsByName('bread-service').forEach(function(el) {
            el.checked = true;
        });
    } else {
        document.getElementsByName('bread-service').forEach(function(el) {
            el.checked = false;
        });
    };
    
    calculateChange();
}
function onOddsEndsInput() {
    if (this.checked === true) {
        document.getElementsByName('odds-and-ends').forEach(function(el) {
            el.checked = true;
        });
    } else {
        document.getElementsByName('odds-and-ends').forEach(function(el) {
            el.checked = false;
        });
    };
    
    calculateChange();
}

function calculateDeposit(total) {
  return total * 0.2;
}

function calculateFoodMinLineItem() {
  if (guestsSlider.value > 200) {
    return 'Inquire';
  } else {
    return calculateFoodMin();
  }
};

function calculateFoodMin() {
  if (guestsSlider.value <= 50) {
    return 5000;
  } else if (guestsSlider.value <= 100) {
    return 7000;
  } else if (guestsSlider.value <= 150) {
    return 8500;
  } else {
    return 10000;
  };
};

function calculateDinnerCost() {
  if (buffetInput.checked === true) {
    familyInput.checked = false;
    platedInput.checked = false;
    dinnerCostLineItem.style.display = 'flex';
    dinnerSelectionDisplay.innerText = "Serviced Buffet Dinner";
    dinnerCostDisplay.innerHTML = "$60 per";
    dinnerCostInput = 60;
    return 60;
  } else if (familyInput.checked === true) {
    buffetInput.checked = false;
    platedInput.checked = false;
    dinnerCostLineItem.style.display = 'flex';
    dinnerSelectionDisplay.innerText = "Seated Family Style Dinner";
    dinnerCostDisplay.innerHTML = "$70 per";
    dinnerCostInput = 70;
    return 70;
  } else if (platedInput.checked === true) {
    buffetInput.checked = false;
    familyInput.checked = false;
    dinnerCostLineItem.style.display = 'flex';
    dinnerSelectionDisplay.innerText = "Seated Plated Dinner";
    dinnerCostDisplay.innerHTML = "$80 per";
    dinnerCostInput = 80;
    return 80;
  } else {
    dinnerCostLineItem.style.display = 'none';
    dinnerCostInput = 0;
    return 0;
  };
};

function calculateBreadCost() {
  if (breadInput.checked === true) {
    breadCostLineItem.style.display = 'flex';
    breadSelectionDisplay.innerText = "Bread Service";
    breadCostDisplay.innerHTML = "$7 per";
    breadCostInput = 7;
    return 7;
  } else {
    breadCostLineItem.style.display = 'none';
    breadCostInput = 0;
    return 0;
  };
};

function calculateOddsEndsCost() {
  if (oddsEndsInput.checked === true) {
    oddsEndsCostLineItem.style.display = 'flex';
    oddsEndsSelectionDisplay.innerText = "Odds & Ends";
    oddsEndsCostDisplay.innerHTML = "$8 per";
    oddsEndsCostInput = 8;
    return 8;
  } else {
    oddsEndsCostLineItem.style.display = 'none';
    oddsEndsCostInput = 0;
    return 0;
  };
};

function calculateStationAppetizersCost() {
  if (stationAppetizersInput.checked === true) {
    stationAppetizersCostLineItem.style.display = 'flex';
    stationAppetizersSelectionDisplay.innerText = "Station Appetizers";
    stationAppetizersCostDisplay.innerHTML = "$30 per";
    stationAppetizersCostInput = 30;
    return 30;
  } else {
    stationAppetizersCostLineItem.style.display = 'none';
    stationAppetizersCostInput = 0;
    return 0;
  };
};

function calculatePassedSavoryAppetizersCost() {
  if (passedSavoryAppetizersInput.checked === true) {
    passedSavoryAppetizersCostLineItem.style.display = 'flex';
    passedSavoryAppetizersSelectionDisplay.innerText = "Passed Savory Appetizers";
    passedSavoryAppetizersCostDisplay.innerHTML = "$35 per";
    passedSavoryAppetizersCostInput = 35;
    return 35;
  } else {
    passedSavoryAppetizersCostLineItem.style.display = 'none';
    passedSavoryAppetizersCostInput = 0;
    return 0;
  };
};

function calculatePassedDessertsCost() {
  if (passedDessertsInput.checked === true) {
    passedDessertsCostLineItem.style.display = 'flex';
    passedDessertsSelectionDisplay.innerText = "Passed Desserts";
    passedDessertsCostDisplay.innerHTML = "$14 per";
    passedDessertsCostInput = 14;
    return 14;
  }  else {
    passedDessertsCostLineItem.style.display = 'none';
    passedDessertsCostInput = 0;
    return 0;
  };
};

function calculateLunchCost() {
  if (lunchInput.checked === true) {
    lunchCostLineItem.style.display = 'flex';
    lunchSelectionDisplay.innerText = "Lunch";
    lunchCostDisplay.innerHTML = "$25 per";
    lunchCostInput = 25;
    return 25;
  }  else {
    lunchCostLineItem.style.display = 'none';
    lunchCostInput = 0;
    return 0;
  };
};

function calculateOpenBarCost() {
    var cost;

  if (openBarInput.checked === true) {
    openBarCostLineItem.style.display = 'flex';
    openBarSelectionDisplay.innerText = "Open bar";

    if (endTime.timepicker('getTime') && startTime.timepicker('getTime')) {
        eventLength = endTime.timepicker('getTime').getHours() - startTime.timepicker('getTime').getHours();
        cost = ((eventLength * 15) + 15) * guestsInput.value;
        openBarCostDisplay.innerHTML = "$" + cost;
        openBarCostInput = cost;
        return cost;
    } else {
        openBarCostDisplay.innerHTML = 'select event hours'
        openBarCostInput = 0;
        return 0
    }
  }  else {
    openBarCostLineItem.style.display = 'none';
    openBarCostInput = 0;
    return 0;
  };
};

function calculateStaffedbarCost() {
  if (staffedbarInput.checked === true) {
    staffedbarCostLineItem.style.display = 'flex';
    staffedbarSelectionDisplay.innerText = "Passed Desserts";
    staffedbarCostDisplay.innerHTML = "$14 per";
    staffedbarCostInput = 14;
    return 14;
  }  else {
    staffedbarCostLineItem.style.display = 'none';
    staffedbarCostInput = 0;
    return 0;
  };
};

function calculateTotalCost() {
    return (
        calculateDinnerCost() + 
        calculateBreadCost() + 
        calculateOddsEndsCost() + 
        calculateStationAppetizersCost() +
        calculatePassedSavoryAppetizersCost() +
        calculatePassedDessertsCost() +
        calculateLunchCost()
    ) * Number(guestsInput.value);
};
</script>
